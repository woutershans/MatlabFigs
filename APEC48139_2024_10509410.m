close all; clear;
colors = ["black", "#FF5050", "#77C8A6", "#42ACC6", "#588DCA", "#897AFA", "#9A9CA1", "red", "green", "blue", "cyan", "magneta", "yellow"];
colorsPASTEL = ["#3B3B3B", "#FF9C9C", "#BEEBD8", "#9BD9E9", "#88ABCC", "#C7BDF9", "#C6C9CF"];
colorsDARK = ["#000000", "#992F2F", "#417C61", "#3C7AB4", "#3D618A", "#545096", "#000000"];
colorsR = [[153, 47, 47]./255 [255, 80, 80]./255 [255, 155, 155]./255];
colorsG = [[81, 138, 114]./255 [119, 200, 166]./255 [165, 213, 191]./255];
colorsB = [[61, 97, 138]./255 [88, 141, 202]./255 [124, 159, 200]./255];


%% Plot spider graph from experimental results

%          Cp/pF    Cs/pF   Cps/pF  Lk/uH   Rac/mOhm
non_int = [118      118     90      1.50    93.12];
ss1_int = [22.1     22.1    2820    0.31    117.1];
as2_int = [67.5     67.1    437     0.25    69.40];

refdata = [118      118     2820    1.50    117.1];  % reference values considered as 100%

non_int_rel = round(non_int./refdata.*100, 2);
ss1_int_rel = round(ss1_int./refdata.*100, 2);
as2_int_rel = round(as2_int./refdata.*100, 2);

labels = [non_int_rel; ss1_int_rel; as2_int_rel];

plotSpider = false;
if plotSpider == true
    figure('units','centimeters','position',[[1 1] [15 10]]); hold on;
    % Spider plot
    spider_plot_R2019b(labels,...
        'AxesLabels', {'Cp (118 nF)', 'Cs (118 nF)', 'Cps (2820 nF)', 'Lk (1.5 uH)', 'Rac (190 mOhm)'},...
        'AxesInterval', 2, ...
        'AxesLimits', [0, 0, 0, 0, 0; 100, 100, 100, 100, 100], ...
        'FillOption', {'on', 'on', 'on'}, ...
        'FillTransparency', [0.1, 0.1, 0.1], ...
        'Color', [hex2rgb(colorsPASTEL(5)); hex2rgb(colors(5)); hex2rgb(colorsDARK(5))]);
    legend('Non-Int', 'SS1-Int', 'AS2-Int', 'Location', 'northwest');
    %figName = "spider_raw"; export_fig(fullfile('Figures', figName), '-pdf', '-nocrop', '-transparent');
end



%% Plot simulations on ZVS (data from Zuo)

t = [0.0227361 0.0227362 0.0227363 0.0227364 0.0227365 0.0227366 0.0227367 0.0227368 0.0227369 0.0227370 0.0227371 0.0227372 0.0227373 0.0227374 0.0227375 0.0227376 0.0227377 0.0227378 0.0227379 0.0227380 0.0227381 0.0227382 0.0227383 0.0227384 0.0227385 0.0227386 0.0227387 0.0227388 0.0227389 0.0227390 0.0227391 0.0227392 0.0227393 0.0227394 0.0227395 0.0227396 0.0227397 0.0227398 0.0227399 0.0227400 0.0227401 0.0227402 0.0227403 0.0227404 0.0227405 0.0227406 0.0227407 0.0227408 0.0227409 0.0227410 0.0227411 0.0227412 0.0227413 0.0227414 0.0227415 0.0227416 0.0227417 0.0227418 0.0227419 0.0227420 0.0227421 0.0227422]-0.0227361;
vg1 = [1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000];
vg2 = [0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000];
vds1 = [0.0000162 0.0000703 0.0001164 0.0001497 0.0001678 0.0001698 0.0001564 0.0001298 0.0000934 400.0000314 399.9999621 399.9999023 399.9998518 399.9998160 399.9997973 399.9997963 399.9998123 399.9998424 399.9998835 -0.0000085 0.0000079 0.0000607 0.0001058 0.0001378 0.0001548 0.0001559 0.0001421 0.0001156 0.0000799 446.0056825 399.9999438 399.9998883 399.9998430 399.9998128 399.9998000 399.9998046 399.9998253 399.9998592 399.9999030 20.7787923 0.0000161 0.0000650 0.0001099 0.0001420 0.0001595 0.0001615 0.0001490 0.0001241 0.0000903 400.0000247 399.9999593 399.9999060 399.9998621 399.9998325 399.9998193 399.9998228 399.9998418 399.9998735 399.9999146 45.9517194 0.0000208 0.0000749];
vds2 = [399.9999822 399.9999226 399.9998719 399.9998354 399.9998154 399.9998132 399.9998279 399.9998572 399.9998973 -0.0000285 0.0000344 0.0000888 0.0001347 0.0001673 0.0001843 0.0001851 0.0001707 0.0001432 0.0001059 400.0000094 399.9999913 399.9999332 399.9998837 399.9998485 399.9998297 399.9998285 399.9998437 399.9998728 399.9999121 -46.0056825 0.0000511 0.0001015 0.0001428 0.0001702 0.0001819 0.0001777 0.0001588 0.0001280 0.0000882 379.2212077 399.9999823 399.9999286 399.9998791 399.9998438 399.9998245 399.9998223 399.9998361 399.9998634 399.9999007 -0.0000224 0.0000370 0.0000855 0.0001254 0.0001523 0.0001643 0.0001611 0.0001438 0.0001150 0.0000776 354.0482806 399.9999771 399.9999176];
vg3 = [0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000];
vg4 = [1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.0000000 1.0000000];
vds3 = [399.9999822 399.9999226 399.9998719 399.9998354 399.9998154 399.9998132 399.9998279 399.9998572 399.9998973 -0.0000285 0.0000344 0.0000888 0.0001347 0.0001673 0.0001843 0.0001851 0.0001707 0.0001432 0.0001059 400.0000094 399.9999913 399.9999332 399.9998837 399.9998485 399.9998297 399.9998285 399.9998437 399.9998728 399.9999121 -46.0056922 0.0000511 0.0001015 0.0001428 0.0001702 0.0001819 0.0001777 0.0001588 0.0001280 0.0000882 379.2212081 399.9999823 399.9999286 399.9998791 399.9998438 399.9998245 399.9998223 399.9998361 399.9998634 399.9999007 -0.0000224 0.0000370 0.0000855 0.0001254 0.0001523 0.0001643 0.0001611 0.0001438 0.0001150 0.0000776 354.0482798 399.9999771 399.9999176];
vds4 = [0.0000162 0.0000703 0.0001164 0.0001497 0.0001678 0.0001698 0.0001564 0.0001298 0.0000934 400.0000314 399.9999621 399.9999023 399.9998518 399.9998160 399.9997973 399.9997963 399.9998123 399.9998424 399.9998835 -0.0000085 0.0000079 0.0000607 0.0001058 0.0001378 0.0001548 0.0001559 0.0001421 0.0001156 0.0000799 446.0056922 399.9999438 399.9998883 399.9998430 399.9998128 399.9998000 399.9998046 399.9998253 399.9998592 399.9999030 20.7787919 0.0000161 0.0000650 0.0001099 0.0001420 0.0001595 0.0001615 0.0001490 0.0001241 0.0000903 400.0000247 399.9999593 399.9999060 399.9998621 399.9998325 399.9998193 399.9998228 399.9998418 399.9998735 399.9999146 45.9517202 0.0000208 0.0000749];

plotSim = true;
if plotSim == true
    figure('units','centimeters','position',[[2 2] [15 4]]); 
    subplot(2,1,1); hold on;
    plot(t.*1e6, vg1, '-', 'color', colorsDARK(5), 'LineWidth', 2);
    plot(t.*1e6, vg2, '-', 'color', colorsPASTEL(5), 'LineWidth', 2);
    legend({'Gate 1', 'Gate 2'}, 'Orientation', 'vertical', 'Location', 'northeast');
    %xlabel('Time (us)'); 
    ylabel('Voltage (V)');
    ylim(1.2.*[0 1]); xlim([0 6])
    grid on; ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1; box on;

    subplot(2,1,2); hold on;
    plot(t.*1e6, vds1, '-', 'color', colorsDARK(5), 'LineWidth', 2);
    plot(t.*1e6, vds2, '-', 'color', colorsPASTEL(5), 'LineWidth', 2);
    legend({'Drain-source 1', 'Drain-source 2'}, 'Orientation', 'vertical', 'Location', 'northeast');
    %xlabel('Time (us)'); 
    ylabel('Voltage (V)');
    ylim(1.2.*[0 400]); xlim([0 6])
    grid on; ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1; box on;

    %figName = "sim_zvs"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end




%% sim waves vi
t2 = [0.0229003 0.0229004 0.0229005 0.0229006 0.0229007 0.0229008 0.0229009 0.0229010 0.0229011 0.0229012 0.0229013 0.0229014 0.0229015 0.0229016 0.0229017 0.0229018 0.0229019 0.0229020 0.0229021 0.0229022 0.0229023 0.0229024 0.0229025 0.0229026 0.0229027 0.0229028 0.0229029 0.0229030 0.0229031 0.0229032 0.0229033 0.0229034 0.0229035 0.0229036 0.0229037 0.0229038 0.0229039 0.0229040 0.0229041 0.0229042 0.0229043 0.0229044 0.0229045 0.0229046 0.0229047 0.0229048 0.0229049 0.0229050 0.0229051 0.0229052 0.0229053 0.0229054 0.0229055 0.0229056 0.0229057 0.0229058 0.0229059 0.0229060 0.0229061 0.0229062 0.0229063 0.0229064 0.0229065 0.0229066 0.0229067 0.0229068 0.0229069 0.0229070 0.0229071 0.0229072 0.0229073 0.0229074 0.0229075 0.0229076 0.0229077 0.0229078 0.0229079 0.0229080 0.0229081 0.0229082 0.0229083 0.0229084 0.0229085 0.0229086 0.0229087 0.0229088 0.0229089 0.0229090 0.0229091 0.0229092 0.0229093 0.0229094 0.0229095 0.0229096 0.0229097 0.0229098 0.0229099 0.0229100 0.0229101 0.0229102 0.0229103 0.0229104 0.0229105 0.0229106 0.0229107 0.0229108 0.0229109 0.0229110 0.0229111]-0.0229003;
vt1 = [399.9997811 399.9997200 399.9996903 399.9996933 399.9997265 399.9997847 399.9998605 -428.2282420 -399.9998908 -399.9997835 -399.9996952 -399.9996357 -399.9996090 -399.9996160 -399.9996541 -399.9997179 -399.9998012 385.5877131 399.9999673 399.9998624 399.9997673 399.9996997 399.9996632 399.9996597 399.9996871 399.9997405 399.9998127 -400.0000433 -399.9999173 -399.9998140 -399.9997292 -399.9996727 -399.9996483 -399.9996568 -399.9996956 -399.9997593 -399.9998409 268.2761427 399.9999495 399.9998307 399.9997294 399.9996554 399.9996136 399.9996060 399.9996308 399.9996839 399.9997583 -400.0000377 -400.0000007 -399.9998863 -399.9997957 -399.9997268 -399.9996894 -399.9996854 -399.9997132 -399.9997683 -399.9998436 58.6325695 399.9999606 399.9998481 399.9997381 399.9996526 399.9995973 399.9995763 399.9995894 399.9996335 399.9997026 -400.0001622 -400.0000148 -399.9999064 -399.9998041 -399.9997220 -399.9996699 -399.9996508 -399.9996645 -399.9997076 -399.9997736 369.5814898 399.9999647 399.9998516 399.9997552 399.9996849 399.9996458 399.9996400 399.9996662 399.9997202 399.9997950 -400.0000666 -399.9999313 -399.9998171 -399.9997206 -399.9996519 -399.9996154 -399.9996126 -399.9996417 -399.9996978 -399.9997748 400.0000225 399.9999892 399.9998795 399.9997859 399.9997196 399.9996847 399.9996830 399.9997125 399.9997685 399.9998437 -217.6671406 -399.9999266];
vt2 = [392.0322890 392.1090817 392.1874027 392.2518134 392.2873273 392.2807722 392.2221778 -392.1208076 -392.0951815 -392.1043430 -392.1327963 -392.1780245 -392.2253941 -392.2592180 -392.2642740 -392.2273069 -392.1301130 392.0128394 392.0150182 392.0441381 392.0918771 392.1560428 392.2225575 392.2760534 392.3014245 392.2852031 392.2169822 -392.1369349 -392.1235046 -392.1446768 -392.1849888 -392.2419715 -392.3011840 -392.3471822 -392.3650156 -392.3416900 -392.2764429 357.5174093 392.1230291 392.1308877 392.1594512 392.2072428 392.2600857 392.3022899 392.3181468 392.2934811 392.2226789 -392.1069070 -392.1038929 -392.1401322 -392.2039952 -392.2803971 -392.3635019 -392.4377071 -392.4874054 -392.4984971 -392.4597586 49.5875046 392.2845552 392.2574482 392.2559405 392.2812954 392.3205565 392.3584729 392.3790776 392.3671314 392.3097444 -392.2047719 -392.1785524 -392.1955691 -392.2381679 -392.2957302 -392.3637782 -392.4272001 -392.4703337 -392.4784892 -392.4393785 257.1757915 392.3050481 392.3117569 392.3409181 392.3919499 392.4511208 392.5030997 392.5324122 392.5249672 392.4694284 -392.3661735 -392.3409469 -392.3505675 -392.3799613 -392.4271190 -392.4777680 -392.5163001 -392.5272860 -392.4969923 -392.4131522 392.2970792 392.3014021 392.3365824 392.3921385 392.4664714 392.5454001 392.6133938 392.6550955 392.6567505 392.6076327 -242.2850788 -392.4634703];
i1 = [10.4227949 13.3325806 14.7485709 14.6043462 13.0241570 10.2512447 6.6434698 0.6044008 -5.1995611 -10.3087927 -14.5152335 -17.3492109 -18.6182127 -18.2872562 -16.4718976 -13.4321094 -9.4644566 -3.4251618 1.2846768 6.5532676 11.0800257 14.3020310 16.0388147 16.2036923 14.9008820 12.3571866 8.9168476 1.7874821 -3.9378753 -8.8570670 -12.8946573 -15.5855574 -16.7455691 -16.3437746 -14.4969573 -11.4639414 -7.5756331 -2.9136835 2.4060050 8.0638978 12.8853446 16.4079575 18.3993324 18.7628420 17.5787199 15.0534028 11.5098745 5.2824634 0.0667071 -5.4128699 -9.7283042 -13.0091289 -14.7887204 -14.9813788 -13.6566780 -11.0309691 -7.4477129 -1.9996375 1.4238000 7.2331495 12.4737044 16.5451707 19.1744049 20.1745232 19.5510468 17.4544190 14.1624826 7.7248191 1.3449863 -4.4561711 -9.3267168 -13.2397834 -15.7201251 -16.6275238 -15.9748599 -13.9259682 -10.7800812 -3.3553745 1.6794833 7.0664362 11.6579589 15.0043055 16.8671728 17.1425681 15.8966653 13.3228165 9.7630925 2.8572949 -3.2731014 -8.7114640 -13.3038055 -16.5780218 -18.3138420 -18.4461616 -17.0601400 -14.3900585 -10.7245499 -4.5611688 0.5120086 5.7391571 10.1952979 13.3502653 15.0152013 15.0934085 13.6913474 11.0231022 7.4434509 2.0418947 -3.4957014];
i2 = [17.0176218 17.9432474 17.3302659 15.1677412 11.5560360 6.7566786 1.1477161 -3.9026557 -8.2147108 -11.4626991 -13.8293976 -14.8223938 -14.2631536 -12.1183010 -8.5132440 -3.7148963 1.9696060 5.9067409 10.2195991 13.4275450 15.7194777 16.7184084 16.1956257 14.1206200 10.5753408 5.8044343 0.1746079 -5.2650797 -9.4311735 -12.6589503 -15.0073410 -15.9983858 -15.4592763 -13.3611608 -9.8305250 -5.1312268 0.4054088 3.2687825 8.0000329 11.3697282 13.9453139 15.2200463 14.9611820 13.0978049 9.6960065 4.9953335 -0.7000610 -5.2070411 -10.6225653 -14.2392137 -16.7279227 -18.1623530 -18.0755808 -16.3895011 -13.1801322 -8.6719723 -3.2148560 1.9271172 3.9954857 8.0257066 11.2790474 13.4013481 14.0649205 13.1375064 10.6071173 6.6301442 1.5190819 -3.7119398 -8.2478558 -11.9281757 -14.6742843 -16.4484662 -16.7775549 -15.5296239 -12.7255203 -8.5377305 -3.2732762 2.8321149 7.7402520 11.3134785 14.1297058 15.6922725 15.7633595 14.2597154 11.2349803 6.9110371 1.6161478 -4.0775315 -8.2496169 -11.5257880 -13.9666063 -15.0832865 -14.6703908 -12.6652226 -9.1651362 -4.4109531 1.3005232 5.6470659 10.6862628 14.0972412 16.6276165 17.8585957 17.5537426 15.6782869 12.3008888 7.6721668 2.1464996 -2.1516234 -6.9821685];

plotSim2 = true;
if plotSim2
    figure('units','centimeters','position',[[17 2] [15 4]]); 
    subplot(2,1,1); hold on;
    plot(t2.*1e6, vt1, '-', 'color', colorsDARK(5), 'LineWidth', 2);
    plot(t2.*1e6, vt2, '-', 'color', colorsPASTEL(5), 'LineWidth', 2);
    legend({'Primary', 'Secondary'}, 'Orientation', 'vertical', 'Location', 'northeast');
    %xlabel('Time (us)');
    ylabel('Voltage (V)');
    ylim(1.2.*[-400 400]); xlim([0 6])
    grid on; ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1; box on;

    subplot(2,1,2); hold on;
    plot(t2.*1e6, i1, '-', 'color', colorsDARK(5), 'LineWidth', 2);
    plot(t2.*1e6, i2, '-', 'color', colorsPASTEL(5), 'LineWidth', 2);
    legend({'Primary', 'Secondary'}, 'Orientation', 'vertical', 'Location', 'northeast');
    xlabel('Time (us)'); ylabel('Current (A)');
    ylim(1.2.*[-18 18]); xlim([0 6])
    grid on; ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1; box on;
    %figName = "sim_vi"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end


%% Plot converter losses piechart

piezuo = true;
if piezuo == true
    % Input the values
    XX = [6.56 9.75 6 1.5 2 2 1];  % [W] loss values
    X = XX/sum(XX)*100;  % [%] percentage values
    
    % Prepare the labels with values and percentages
    value = compose([newline '(%.0f W)'], XX);
    percents = compose('%.0f%%', X/sum(X)*100);
    
    % Plot the figure
    figure('units','centimeters','position',[[8 8] [15 8]]);
    p0 = pie(X, strcat(percents, value));
    
    % Set the colors for each slice
    set(p0(1), 'FaceColor', colorsDARK{5});   % Boost inductors losses
    set(p0(3), 'FaceColor', colors{5});       % Primary switching losses
    set(p0(5), 'FaceColor', colorsPASTEL{5}); % Transformer losses
    set(p0(7), 'FaceColor', colorsDARK{3});   % Capacitors losses
    set(p0(9), 'FaceColor', colors{3});       % Diodes losses
    set(p0(11), 'FaceColor', colorsPASTEL{3});% Auxiliary losses
    set(p0(13), 'FaceColor', colors{7});  % Other losses
    
    legend({'Boost inductors losses', 'Primary switching losses', 'Transformer losses', 'Capacitors losses', 'Diodes losses', 'Auxiliary losses', 'Other losses'}, 'Orientation', 'vertical', 'Location', 'southwest');
    %figName = "zuo_pie"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');

end


%% Plot comparison Pfe

plotFeComp = false;
if plotFeComp == true
    X = categorical({'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    X = reordercats(X,{'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    Y = [19.6, 19.6, 19.6, 19.6, 19.6];
    
    figure('units','centimeters','position',[[2 2] [8 8]]); hold on;
    b0 = bar(X, Y, 'FaceColor', colorsDARK(5));
    text(1:length(Y),Y,num2str(Y',4),'vert','bottom','horiz','center'); box off;
    ylabel('Core losses (W)')
    ylim([0 25]);
    grid on; box on;
    ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1;
    figName = "sim_Pfe"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end

%% Plot comparison Pcu

plotCuComp = false;
if plotCuComp == true
    X = categorical({'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    X = reordercats(X,{'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    Y = [6.4, 3.0, 3.0, 3.5, 3.5];
    
    figure('units','centimeters','position',[[4 4] [8 8]]); hold on;
    b0 = bar(X, Y, 'FaceColor', colorsPASTEL(5));
    text(1:length(Y),Y,num2str(Y',4),'vert','bottom','horiz','center'); box off;
    ylabel('Winding losses (W)')
    ylim([0 10]);
    grid on; box on;
    ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1;
    figName = "sim_Pcu"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end



%% Plot comparison Lk

plotLkComp = false;
if plotLkComp == true
    X = categorical({'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    X = reordercats(X,{'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    Y = [1.02, 0.03, 0.03, 0.13, 0.14];
    
    figure('units','centimeters','position',[[6 6] [8 8]]); hold on;
    b0 = bar(X, Y, 'FaceColor', colorsDARK(2));
    text(1:length(Y),Y,num2str(Y',4),'vert','bottom','horiz','center'); box off;
    ylabel('Leakage inductance (uH)')
    ylim([0 1.25]);
    grid on; box on;
    ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1;
    figName = "sim_Lk"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end

%% Plot comparison Ci

plotCiComp = false;
if plotCiComp == true
    X = categorical({'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    X = reordercats(X,{'Non-Int.', 'Full-Int.', 'SS1-Int.', 'SS2-Int.', ' AS2-Int.'});
    Y = [0.09, 3.11, 2.83, 0.38, 0.36];
    
    figure('units','centimeters','position',[[8 8] [8 8]]); hold on;
    b0 = bar(X, Y, 'FaceColor', colorsPASTEL(2));
    text(1:length(Y),Y,num2str(Y',4),'vert','bottom','horiz','center'); box off;
    ylabel('Interwinding capacitance (nF)')
    ylim([0 3.5]);
    grid on; box on;
    ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1;
    figName = "sim_Ci"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end



%% Plot comparisons of different FEA solvers and analytical models

simComp = true;
if simComp == true
    lossData = [18.6, 20.4, 19.6, 18.3;  % core losses
                2.97, 3.05, 2.74, 3.69]; % winding losses
    lossCategories = {'Analytical', '2D Eddy Sim.', '3D Eddy Sim.', '3D Transient Sim.'};
    
    figure('units','centimeters','position',[[8 8] [15 8]]); hold on;
    b0 = bar(lossData', 'grouped', 'BarWidth', 1.5);
    b0(1).FaceColor = colorsDARK(5);
    b0(2).FaceColor = colorsPASTEL(5);
    x = b0(1).XEndPoints;
    y1 = b0(1).YEndPoints;
    y2 = b0(2).YEndPoints;
    for i = 1:length(x)
        text(x(i), y1(i), num2str(lossData(1,i)), 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom');
        text(x(i), y2(i), num2str(lossData(2,i)), 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom');
    end
    ylabel('Losses (W)');
    legend('Core loss', 'Winding loss', 'Location', 'northeast')
    set(gca, 'XTickLabel', lossCategories, 'XTick',1:numel(lossCategories))
    ylim([0 27.5]);
    grid on; box on;
    ax = gca; ax.GridLineStyle = ':'; ax.GridColor = 'k'; ax.GridAlpha = 1;
    figName = "sim_comp"; export_fig(fullfile(figName), '-pdf', '-nocrop', '-transparent');
end

